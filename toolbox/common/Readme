common functions for the preprocessing and modeling
